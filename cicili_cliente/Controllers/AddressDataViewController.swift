////  AddressDataViewController.swift//  cicili_cliente////  Created by ARIANA SANCHEZ on 11/01/20.//  Copyright Â© 2020 CICILI. All rights reserved.//import UIKitextension UITextField {    func callAddressTable(selfV : AddressDataViewController, selector: Selector) {                let townView = selfV.storyboard?.instantiateViewController(withIdentifier: "SuburbsViewControllerID") as! SuburbsViewController                townView.delegate=selfV        selfV.navigationController?.pushViewController(townView, animated: true)    }}class AddressDataViewController:  UIViewController, UITextFieldDelegate {    @IBOutlet weak var preselectedSwitch: UISwitch!    @IBOutlet weak var townTextField: UITextField!    @IBOutlet weak var intNumberTextField: UITextField!    @IBOutlet weak var extNumberTextField: UITextField!    @IBOutlet weak var streetTextField: UITextField!    @IBOutlet weak var zipcodeTextField: UITextField!    @IBOutlet weak var AliasTextField: UITextField!    let address = Address()                var cliente: Cliente?    var suburbsObj: DataByZipCode?    // variable que me indica que view controller es el que precede al actual, para saber si se    // muestra o no la navigation bar al dar clic en regresar    var predecessor: String?    var addressForLocation: String?        override func viewDidLoad() {        super.viewDidLoad()        //view.backgroundColor = .white        navigationController?.setNavigationBarHidden(false, animated: true)        self.navigationItem.leftBarButtonItem = UIBarButtonItem(title: "Regresar", style: .plain, target: self, action: #selector(handleCancel))                // Do any additional setup after loading the view.                AliasTextField.becomeFirstResponder()        let gesture = UITapGestureRecognizer(target: view, action: #selector(UIView.endEditing(_:)))                      view.addGestureRecognizer(gesture)                intNumberTextField.delegate = self        extNumberTextField.delegate = self        streetTextField.delegate = self        AliasTextField.delegate = self        zipcodeTextField.delegate = self               AliasTextField.tag = 1        zipcodeTextField.tag = 2        streetTextField.tag = 3        extNumberTextField.tag = 4        intNumberTextField.tag = 5                //self.townTextField.callAddressTable(selfV: self, selector: #selector(tapDone))                           }        @objc func tapDone() {                self.townTextField.text=""        self.townTextField.resignFirstResponder()    }    @IBAction func saveAddressButton(_ sender: UIButton) {                if let aliasInput = AliasTextField.text, !aliasInput.isEmpty, let zipcodeInput = zipcodeTextField.text, !zipcodeInput.isEmpty,            let streetInputInput = streetTextField.text, !streetInputInput.isEmpty,            let externalInputInput = extNumberTextField.text, !externalInputInput.isEmpty,            let internalInputInput = intNumberTextField.text, !internalInputInput.isEmpty,            let townInputInput = townTextField.text, !townInputInput.isEmpty {                                let asentamiento = Asentamiento()                        //asentamiento.cp = Int(zipcodeInput)!            //asentamiento.estado = ""            //asentamiento.municipio = ""            //asentamiento.nombre = ""            asentamiento.id = townTextField.tag            asentamiento.text = townTextField.text                        address.alias = aliasInput            address.cp = zipcodeInput            address.calle = streetInputInput            address.interior = externalInputInput            address.exterior = internalInputInput            address.latitud = 0            address.longitud = 0            address.asentamiento = asentamiento            //address.asentamiento = townInputInput    addressForLocation = "\(String(describing: suburbsObj?.municipio?.text)), \(String(describing: suburbsObj?.estado?.text)), \(String(describing: suburbsObj?.pais?.text))"                                    self.AliasTextField.text = ""            self.zipcodeTextField.text = ""            self.streetTextField.text = ""                        self.performSegue(withIdentifier: Constants.Storyboard.addressLocationSegueId, sender: self)                                           } else {            self.showAlertController(tittle_t: Constants.ErrorTittles.titleRequerido, message_t: Constants.ErrorMessages.messageRequeridoLogin)        }            }    /*    // MARK: - Navigation    // In a storyboard-based application, you will often want to do a little preparation before navigation    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {        // Get the new view controller using segue.destination.        // Pass the selected object to the new view controller.    }    */    @IBAction func hasChangued(_ sender: UITextField) {        debugPrint("Has CHANGED")        debugPrint(sender)        if let zipCodeInput = sender.text, !zipCodeInput.isEmpty{            debugPrint("Has CHANGED NO EMPTY")            debugPrint(zipCodeInput)            if zipCodeInput.count > 4{                debugPrint("Has CHANGED BIGTHAN4")                debugPrint(zipCodeInput.count)                RequestManager.fetchZipCode(oauthToken: cliente!.token!, codeToVerify: zipCodeInput, success: { response in                    print("En success get zipcode  data \(String(describing: response.toJSONString(prettyPrint: true)))")                    if response.asentamientos!.count > 0 {                        self.suburbsObj = response                    }                    else{                        self.showAlertController(tittle_t: Constants.ErrorTittles.titleVerificaCP, message_t: Constants.ErrorMessages.messageVerificaCP)                    }                                    })                { error in                    self.showAlertController(tittle_t: Constants.ErrorTittles.titleVerifica, message_t: error.localizedDescription)                }            }        }    }            @IBAction func showTableSubirb(_ sender: Any) {        if (self.suburbsObj != nil){            if self.suburbsObj!.asentamientos!.count > 0 {                let townView = self.storyboard?.instantiateViewController(withIdentifier: "SuburbsViewControllerID") as! SuburbsViewController                townView.delegate=self                townView.suburbsJSON = self.suburbsObj                self.navigationController?.pushViewController(townView, animated: true)            }            else{                self.showAlertController(tittle_t: Constants.ErrorTittles.titleVerificaCP, message_t: Constants.ErrorMessages.messageVerificaCP)            }        }else{            self.showAlertController(tittle_t: Constants.ErrorTittles.titleVerificaCP, message_t: Constants.ErrorMessages.messageVerificaCP)        }    }        @objc func handleCancel() {        //self.dismiss(animated: true, completion: nil)        navigationController?.popViewController(animated: true)        if predecessor == "tableview" {            navigationController?.setNavigationBarHidden(false, animated: true)        }else{            navigationController?.setNavigationBarHidden(true, animated: true)        }    }     // navigation    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {        // Get the new view controller using segue.destination.        // Pass the selected object to the new view controller.           if segue.identifier ==  Constants.Storyboard.addressLocationSegueId{            let addressLocationController = segue.destination as! AddressLocationViewController            addressLocationController.addressObject = self.address            addressLocationController.cliente = self.cliente            addressLocationController.dataForLocation = self.addressForLocation        }        }    }extension AddressDataViewController : SuburbsTableDelegate {    func addSuburb(suburb: SuburbsTable) {        self.townTextField.text = suburb.name        self.townTextField.tag = suburb.id    }    }